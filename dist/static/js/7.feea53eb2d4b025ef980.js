webpackJsonp([7],{XHYX:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("IHPB"),n=a.n(s),i=a("HzJ8"),l=a.n(i),r=a("ZLEe"),o=a.n(r),c=a("lC5x"),u=a.n(c),p=a("aA9S"),d=a.n(p),m=a("J0Oq"),h=a.n(m),g=a("glag"),v=a("c2Ch"),f=a("xd7I"),b=a("YXHf"),_=a.n(b);f.default.use(_.a);var w={name:"designProgress",created:function(){var e=h()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.item=this.$store.getters.itemCheck_item,console.log(this.item),e.next=4,Object(v.t)({mouldNo:this.item.mouldNo});case 4:1===(t=e.sent).status&&(this.publish=d()({},this.publish,t.msg));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{objectSpanMethod:function(e){var t=e.row,a=(e.column,e.rowIndex),s=e.columnIndex,n=t.itemAndPlanCodeName;if(this.gTable[n]){if(1===s&&0===a)return{rowspan:this.gTable[n].items.length,colspan:this.ticks[n].length};if(0!==s)return{rowspan:0,colspan:0};if(0===a&&0===s&&3===this.gTable[n].items.length&&!this.gTable[n].items[2].nodeName)return{rowspan:3,colspan:1}}}},mounted:function(){var e=this;return h()(u.a.mark(function t(){var a,s,i,r,c,p,d,m,h,f,b,w,x,y,C,k,M,T,D,I,N,S,$;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=function(e,t){var a=e.getDay()||7,s=864e5*(a-1),n=864e5*(7-a);return 0===t?new Date(e).getTime()-s:new Date(e).getTime()+n},t.next=3,Object(v._16)({mouldCode:e.item.mouldNo});case 3:if(1!==(s=t.sent).status||!s.msg.length){t.next=46;break}e.mapInfo=s.msg,e.gTable=s.msg,console.log(e.mapInfo),i=0;case 9:if(!(i<e.mapInfo.length)){t.next=40;break}if(e.mapInfo[i].items?e.datas[e.mapInfo[i].nodeName]=e.mapInfo[i].items:e.datas[e.mapInfo[i].nodeName]=[],e.times[i]={startTime:e.mapInfo[i].earliestDate,endTime:e.mapInfo[i].latestDate},e.datasKeys=o()(e.datas),!e.datas[e.mapInfo[i].nodeName]){t.next=33;break}for(r=!0,c=!1,p=void 0,t.prev=17,d=l()(e.datas[e.mapInfo[i].nodeName]);!(r=(m=d.next()).done);r=!0)m.value.status=0;t.next=25;break;case 21:t.prev=21,t.t0=t.catch(17),c=!0,p=t.t0;case 25:t.prev=25,t.prev=26,!r&&d.return&&d.return();case 28:if(t.prev=28,!c){t.next=31;break}throw p;case 31:return t.finish(28);case 32:return t.finish(25);case 33:if(e.gTable[i].items&&e.gTable[i].items.length<3&&(e.gTable[i].items=[].concat(n()(e.gTable[i].items),[{nodeName:""},{nodeName:""}])),h=[],f=864e5,e.mapInfo[i].earliestDate&&e.mapInfo[i].latestDate){if(b=new Date(e.mapInfo[i].earliestDate),w=new Date(e.mapInfo[i].latestDate),x=b.getFullYear(),y=w.getFullYear(),C=a(b,0),k=a(w,1),(M=(k-C)/f)>630)for(C=new Date(x+"-01-01").getTime(),k=new Date(y+"-12-31").getTime(),T=x;T<=y;T++)h.push(T+"年1月",T+"年2月",T+"年3月",T+"年4月",T+"年5月",T+"年6月",T+"年7月",T+"年8月",T+"年9月",T+"年10月",T+"年11月",T+"年12月");else if(M>90)for(D=function(t){var a,s,n,i,l,r=void 0;function o(e,t){return[31,null,31,30,31,30,31,31,30,31,30,31][t]||(function(e){return e%400==0||e%4==0&&e%100!=0}(e)?29:28)}(a=new Date(e.$format(t))).getFullYear(),a.getMonth(),a.getMonth(),a.getDate(),a.getDate(),s=a.getFullYear(),n=(a.getMonth()+1<10?"0":"")+(a.getMonth()+1),i=(a.getDate()<10?"0":"")+a.getDate(),l=s.toString().substring(2,s.length),l+n+i,r=function(e,t,a){for(var s=new Date(e,t-1,a),n=s.getFullYear(),i=s.getMonth(),l=s.getDate(),r=0;r<i;r++)l+=o(n,r);var c=new Date(n,0,1).getDay()||7,u=null;return 1===c?u=Math.ceil(l/7):(l-=7-c+1,u=Math.ceil(l/7)),u=(u<10?"0":"")+u}(s,n,i),h.push("W"+r)},I=C;I<k;I+=7*f)D(I);else for(N=C;N<k;N+=f)h.push(e.$format(N));e.ticks.push(h),console.log(e.ticks)}else e.ticks[i]=[];case 37:i++,t.next=9;break;case 40:S=o()(e.datas).length,console.log(S),$=e,setTimeout(function(){for(var e=0;e<S;e++)if($.datas[$.datasKeys[e]].length){var t=new _.a.Chart({container:$.datasKeys[e],width:1e3,height:280,padding:[0,0,0,0]});console.log($.datasKeys[e]),$.$chartInit(t,$.datas[$.datasKeys[e]],$.times[e],0),t.render();var a=screen.availHeight-400;console.log(a),$.tableH=a}},200),t.next=47;break;case 46:s.msg.length||Object(g.Message)({showClose:!0,type:"warning",message:"暂时没有设计进度表的相关数据！"});case 47:case"end":return t.stop()}},t,e,[[17,21,25,33],[26,,28,32]])}))()},computed:{mh:function(){return Number(this.tableH)}},data:function(){return{ticks:[],gTable:[],tableH:"",ganttes:{},item:{},publish:{itemPartFinishMath:"",itemPartMachiningMath:"",itemPartOutsourcingMath:"",itemPartTotal:"",planCompletionTime:"",unqualifiedMath:""},mapInfo:[],datas:{},datasKeys:[],times:[],texture:!0,texture1:!1}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"designProgress"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.$goback}},[e._v("返回")]),e._v(" "),a("div",{staticClass:"info"},[a("el-row",{staticClass:"mt20 mb20",staticStyle:{"font-size":"16px","font-weight":"bold"}},[a("el-tag",[e._v("基本信息：")])],1),e._v(" "),a("el-row",{staticStyle:{"padding-left":"20px"},attrs:{gutter:10,type:"flex",justify:"space-around"}},[a("el-col",{staticClass:"ovw-h",attrs:{span:6}},[a("p",{staticClass:"fl"},[e._v("图片：")]),e._v(" "),a("p",{staticClass:"fl",staticStyle:{width:"calc(100% - 100px)"}},[a("img",{staticStyle:{height:"77px",width:"auto !important"},attrs:{src:e.item.imgUrl,alt:"图例"}})])]),e._v(" "),a("el-col",{attrs:{span:6}},[a("p",[e._v("项目名称："+e._s(e.item.projectName))]),e._v(" "),a("p",[e._v("客户名称："+e._s(e.item.customerUserName))])]),e._v(" "),a("el-col",{attrs:{span:6}},[a("p",{staticClass:"out",attrs:{title:e.item.partName}},[e._v("制品名称："+e._s(e.item.partName))]),e._v(" "),a("p",[e._v("制品尺寸："+e._s(e.item.partNo))])]),e._v(" "),a("el-col",{attrs:{span:6}},[a("p",[e._v("模具编号："+e._s(e.item.mouldNo))])])],1),e._v(" "),a("hr"),e._v(" "),a("el-row",{staticClass:"mt20 mb20",staticStyle:{"font-size":"16px","font-weight":"bold"}},[a("el-tag",[e._v("发布统计：")])],1),e._v(" "),a("el-row",{staticStyle:{"padding-left":"20px"}},[e._v("设计部发布图纸总数:"+e._s(e.publish.drawingCount))]),e._v(" "),a("el-row",{staticStyle:{"padding-left":"20px"},attrs:{gutter:10,type:"flex",justify:"space-around"}},[a("el-col",{staticClass:"ovw-h"},[a("p",[e._v("2D图发布时间："+e._s(e.publish.drawing2dReleaseTime))]),e._v(" "),a("p",{staticClass:"out",attrs:{title:e.publish.changeMouldNotice}},[a("span",[e._v("改模通知发布：最新图纸")]),e._v(" "),a("a",{on:{click:function(t){return e.$clip(e.publish.changeMouldNoticePath)}}},[e._v(e._s(e.publish.changeMouldNotice))])])]),e._v(" "),a("el-col",{staticClass:"ovw-h"},[a("p",[e._v("开粗图发布时间："+e._s(e.publish.drawingKaiChuReleaseTime))]),e._v(" "),a("p",{staticClass:"out",attrs:{title:e.publish.liaison}},[a("span",[e._v("内部联络单发布：")]),e._v(" "),a("a",{on:{click:function(t){return e.$clip(e.publish.liaisonPath)}}},[e._v(e._s(e.publish.liaison))])])]),e._v(" "),a("el-col",{staticClass:"ovw-h"},[a("p",[e._v("爆炸图发布时间："+e._s(e.publish.drawingBaoZhaReleaseTime))]),e._v(" "),a("p",[a("span",[e._v("是否发布蚀纹资料：")]),e._v(" "),a("el-radio",{attrs:{label:e.texture,disabled:""},model:{value:e.publish.texture,callback:function(t){e.$set(e.publish,"texture",t)},expression:"publish.texture"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:e.texture1,disabled:""},model:{value:e.publish.texture,callback:function(t){e.$set(e.publish,"texture",t)},expression:"publish.texture"}},[e._v("否")])],1)]),e._v(" "),a("el-col",{staticClass:"ovw-h"},[a("p",[e._v("3D模具零件图时间："+e._s(e.publish.drawingLingJianReleaseTime))]),e._v(" "),a("p",[a("span",[e._v("是否发布走模资料：")]),e._v(" "),a("el-radio",{attrs:{label:e.texture,disabled:""},model:{value:e.publish.shipmentMould,callback:function(t){e.$set(e.publish,"shipmentMould",t)},expression:"publish.shipmentMould"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:e.texture1,disabled:""},model:{value:e.publish.shipmentMould,callback:function(t){e.$set(e.publish,"shipmentMould",t)},expression:"publish.shipmentMould"}},[e._v("否")])],1)])],1),e._v(" "),a("hr")],1),e._v(" "),a("div",{staticClass:"tn",staticStyle:{padding:"40px"}},e._l(e.datasKeys,function(t,s){return a("div",{key:s,staticClass:"node mt20"},[a("el-tag",[e._v(e._s(t)+"进度查看:")]),e._v(" "),a("div",[e.datas[t].length?e._e():a("p",{staticStyle:{"padding-left":"150px"}},[e._v("暂时没有相关数据！")]),e._v(" "),e.datas[t].length&&e.gTable[s].items?a("el-table",{ref:t,refInFor:!0,staticClass:"mt20",staticStyle:{width:"100%"},attrs:{"header-cell-class-name":"hCell","cell-class-name":"cCell","max-height":e.mh,data:e.gTable[s].items,border:"","span-method":e.objectSpanMethod}},[a("el-table-column",{attrs:{align:"center",fixed:"",prop:"nodeName",label:"工序",width:"180",resizable:!1}}),e._v(" "),e._l(e.ticks[s],function(s,n){return a("el-table-column",{key:n,attrs:{align:"center",label:s,width:"120",resizable:!1},scopedSlots:e._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:t}})]}}],null,!0)})})],2):e._e()],1)],1)}),0)],1)},staticRenderFns:[]};var y=a("C7Lr")(w,x,!1,function(e){a("tEKS")},"data-v-cfe7694a",null);t.default=y.exports},tEKS:function(e,t){}});