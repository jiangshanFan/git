webpackJsonp([40],{"07LT":function(e,t){},W2qN:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("3cXf"),o=a.n(r),l=a("hRKE"),n=a.n(l),s=a("HzJ8"),i=a.n(s),c=a("lC5x"),u=a.n(c),m=a("J0Oq"),p=a.n(m),f=(a("glag"),a("c2Ch")),d={name:"itemsAllocation",created:function(){var e=p()(u.a.mark(function e(){var t,a,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={page:1,size:5},e.next=3,Object(f.z)(t);case 3:return a=e.sent,this.tableData=a.msg,console.log(a),e.next=8,Object(f.R)({type:"XIANGMUJINGLI"});case 8:return this.list.manager=e.sent.msg,e.next=11,Object(f.R)({type:"XIANGMUZHUGUAN"});case 11:return this.list.zhuguan=e.sent.msg,e.next=14,Object(f.R)({type:"XIANGMUGONGCHENGSHI"});case 14:return this.list.engineer=e.sent.msg,e.next=17,Object(f.I)();case 17:return r=e.sent,this.list.stage=this.$objToOthers(r.msg),e.next=21,Object(f.R)({type:"KEHU"});case 21:this.listDown=e.sent.msg,console.log(localStorage.getItem("userLoginVO"));case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{getStage:function(e){var t=!0,a=!1,r=void 0;try{for(var o,l=i()(this.list.stage);!(t=(o=l.next()).done);t=!0){var n=o.value;if(n.id===e)return n.label}}catch(e){a=!0,r=e}finally{try{!t&&l.return&&l.return()}finally{if(a)throw r}}},searchCustomers:function(e){var t=this;""!==e?(this.loading=!0,setTimeout(function(){t.loading=!1,t.list.customer=t.listDown.filter(function(t){return t.userName.toLowerCase().indexOf(e.toLowerCase())>-1})},200)):this.list.customer=[]},getProjectAllotListFunction:function(){var e=this;return p()(u.a.mark(function t(){var a,r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={page:e.currentPage,size:5},""!==e.search.partName&&(a.partName=e.search.partName),""!==e.search.mouldNo&&(a.mouldNo=e.search.mouldNo),""!==e.search.projectManagerName&&(a.projectManagerName=e.search.projectManagerName),console.log(a),t.next=7,Object(f.z)(a);case 7:r=t.sent,e.tableData=r.msg;case 9:case"end":return t.stop()}},t,e)}))()},searchList:function(){var e=this;return p()(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.currentPage=1,e.getProjectAllotListFunction();case 2:case"end":return t.stop()}},t,e)}))()},submitInfo:function(e){var t=this;return p()(u.a.mark(function a(){var r;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(n()(e.customerName)),r={customerId:"number"==typeof e.customerName?e.customerName:e.customerId,id:e.id,mouldNo:e.mouldNo,partName:e.partName,projectEngineerId:"number"==typeof e.projectEngineerName?e.projectEngineerName:e.projectEngineerId,projectManagerId:"number"==typeof e.projectManagerName?e.projectManagerName:e.projectManagerId,projectName:e.projectName,projectStage:e.projectStage,projectZhuguanId:"number"==typeof e.projectZhuguanName?e.projectZhuguanName:e.projectZhuguanId},a.next=4,Object(f._20)(r);case 4:return a.sent,t.dialogFormVisible=!1,a.next=8,Object(f.z)({page:t.currentPage,size:5});case 8:t.tableData=a.sent.msg,console.log(e);case 10:case"end":return a.stop()}},a,t)}))()},edit:function(e){this.dialogFormVisible=!0,this.form=JSON.parse(o()(e)),this.form.projectStage||(this.form.projectStage="DESIGN")},handleCurrentChange:function(e){var t=this;return p()(u.a.mark(function a(){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.currentPage=e,t.getProjectAllotListFunction(),console.log("当前页: "+e);case 3:case"end":return a.stop()}},a,t)}))()}},data:function(){return{search:{partName:"",mouldNo:"",projectManagerName:"",optionsProjectManagerName:[]},tableData:{},stage:{},list:{managerName:"",manager:[],engineerName:"",engineer:[],zhuguanName:"",zhuguan:[],stageName:"",stage:[],customerName:"",customer:[]},listDown:[],loading:!1,formBefore:{},form:{},dialogTitle:"",currentPage:1,size:5,dialogFormVisible:!1,options:[{value:1,label:"进行中"},{value:2,label:"已完成"},{value:3,label:"已延期"}],value:""}}},g={render:function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("div",{attrs:{id:"itemsAllocation"}},[r("div",{staticClass:"section-search mb20 mt20"},[r("el-row",{staticClass:"mb20"},[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"fl mr20"},[r("span",[t._v("制品名称：")]),t._v(" "),r("el-input",{staticStyle:{width:"auto"},attrs:{clearable:""},model:{value:t.search.partName,callback:function(e){t.$set(t.search,"partName",e)},expression:"search.partName"}})],1),t._v(" "),r("div",{staticClass:"fl mr20"},[r("span",[t._v("模具编号：")]),t._v(" "),r("el-input",{staticStyle:{width:"auto"},attrs:{clearable:""},model:{value:t.search.mouldNo,callback:function(e){t.$set(t.search,"mouldNo",e)},expression:"search.mouldNo"}})],1),t._v(" "),r("div",{staticClass:"fl mr20"},[r("span",[t._v("项目经理：")]),t._v(" "),r("el-input",{staticStyle:{width:"auto"},attrs:{clearable:""},model:{value:t.search.projectManagerName,callback:function(e){t.$set(t.search,"projectManagerName",e)},expression:"search.projectManagerName"}})],1),t._v(" "),r("el-button",{staticClass:"fl",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.searchList()}}})],1)],1),t._v(" "),r("hr")],1),t._v(" "),r("div",{staticClass:"allocated mt20",staticStyle:{"padding-left":"30px"}},[r("el-tag",{attrs:{type:"info"}},[t._v("项目分配：")]),t._v(" "),r("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:t.tableData.content,border:"","tooltip-effect":"light","header-cell-class-name":"header_cell table_header_shadow"}},[r("el-table-column",{attrs:{fixed:"left",type:"index",width:"50",label:"序号",index:function(a){return e.$indexS(a,t.currentPage,t.size)}}}),t._v(" "),r("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150"}}),t._v(" "),r("el-table-column",{attrs:{prop:"partName",label:"制品名称",width:"150","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{prop:"mouldNo",label:"模具编号",width:"150"}}),t._v(" "),r("el-table-column",{attrs:{prop:"projectStage",label:"项目阶段",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(t.getStage(e.row.projectStage)))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"projectZhuguanName",label:"项目主管",width:"100","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"projectManagerName",label:"项目经理",width:"100","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"projectEngineerName",label:"项目工程师",width:"100","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"companyName",label:"客户公司名称",width:"120","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"customerName",label:"客户项目联系人",width:"150","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"customerPhone",label:"客户电话",width:"130"}}),t._v(" "),r("el-table-column",{attrs:{prop:"customerEmail",label:"客户邮箱",width:"180"}}),t._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit",plain:""},on:{click:function(a){return t.edit(e.row)}}},[t._v("编辑")])]}}])})],1)],1),t._v(" "),r("div",{staticClass:"pagination fr ovw-h"},[r("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.size,layout:"total, prev, pager, next",total:t.tableData.totalCount},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),r("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogFormVisible,width:"60%",center:""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[r("hr"),t._v(" "),r("el-form",{staticClass:"mt20",attrs:{model:t.form,"label-width":"100px","label-position":"left"}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"模具编号"}},[r("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:t.form.mouldNo,callback:function(e){t.$set(t.form,"mouldNo",e)},expression:"form.mouldNo"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"项目经理"}},[r("el-select",{attrs:{filterable:""},model:{value:t.form.projectManagerName,callback:function(e){t.$set(t.form,"projectManagerName",e)},expression:"form.projectManagerName"}},t._l(t.list.manager,function(e){return r("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})}),1)],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"制品名称"}},[r("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:t.form.partName,callback:function(e){t.$set(t.form,"partName",e)},expression:"form.partName"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"项目工程师"}},[r("el-select",{attrs:{filterable:""},model:{value:t.form.projectEngineerName,callback:function(e){t.$set(t.form,"projectEngineerName",e)},expression:"form.projectEngineerName"}},t._l(t.list.engineer,function(e){return r("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})}),1)],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"项目名称"}},[r("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:t.form.projectName,callback:function(e){t.$set(t.form,"projectName",e)},expression:"form.projectName"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"项目主管"}},[r("el-select",{attrs:{filterable:""},model:{value:t.form.projectZhuguanName,callback:function(e){t.$set(t.form,"projectZhuguanName",e)},expression:"form.projectZhuguanName"}},t._l(t.list.zhuguan,function(e){return r("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})}),1)],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"客户名称"}},[r("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入客户名称","remote-method":t.searchCustomers,loading:t.loading},model:{value:t.form.customerName,callback:function(e){t.$set(t.form,"customerName",e)},expression:"form.customerName"}},t._l(t.list.customer,function(e){return r("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})}),1),t._v(" "),r("span",{staticStyle:{"font-size":"6px",float:"right","line-height":"20px"}},[t._v("提示：可输入关键词查询客户")])],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"项目阶段"}},[r("el-select",{attrs:{filterable:""},model:{value:t.form.projectStage,callback:function(e){t.$set(t.form,"projectStage",e)},expression:"form.projectStage"}},t._l(t.list.stage,function(e){return r("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}),1)],1)],1)],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitInfo(t.form)}}},[t._v("确 定")]),t._v(" "),r("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var h=a("C7Lr")(d,g,!1,function(e){a("07LT")},"data-v-27a26620",null);t.default=h.exports}});