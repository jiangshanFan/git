webpackJsonp([21],{"5cNR":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("lC5x"),o=a.n(n),s=a("J0Oq"),r=a.n(s),i=(a("glag"),a("c2Ch")),l=a("xd7I"),c=a("YXHf"),u=a.n(c);l.default.use(u.a);var f={name:"productPlanTable",created:function(){this.basicInfo=this.$store.getters.itemCheck_item,console.log(this.basicInfo),this.getInfo()},methods:{objectSpanMethod:function(t){t.row,t.column;var e=t.rowIndex,a=t.columnIndex;return 1===a&&0===e?{rowspan:this.gTable.items.length,colspan:this.ticks.length}:0!==a?{rowspan:0,colspan:0}:void 0},export_excel:function(){var t=this;return r()(o.a.mark(function e(){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i._1)({mouldNo:t.$store.getters.itemCheck_item.mouldNo},t.$store.getters.itemCheck_item);case 2:a=e.sent,console.log(a);case 4:case"end":return e.stop()}},e,t)}))()},getInfo:function(){var t=this;return r()(o.a.mark(function e(){var a,n,s,r,l,c,f,g,d,m,v,h,_,b;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(t,e){var a=t.getDay()||7,n=864e5*(a-1),o=864e5*(7-a);return 0===e?new Date(t).getTime()-n:new Date(t).getTime()+o},e.next=3,Object(i._11)({mouldCode:t.basicInfo.mouldNo});case 3:if(1===(n=e.sent).status){if(t.info=n.msg,t.gTable=n.msg,console.log(t.info),t.datas=t.info.items,t.times={startTime:t.info.earliestDate,endTime:t.info.latestDate},s=864e5,t.info.earliestDate&&t.info.latestDate){if(r=new Date(t.info.earliestDate),l=new Date(t.info.latestDate),c=r.getFullYear(),f=l.getFullYear(),g=a(r,0),d=a(l,1),(m=(d-g)/s)>630)for(g=new Date(c+"-01-01").getTime(),d=new Date(f+"-12-31").getTime(),v=c;v<=f;v++)t.ticks.push(v+"年1月",v+"年2月",v+"年3月",v+"年4月",v+"年5月",v+"年6月",v+"年7月",v+"年8月",v+"年9月",v+"年10月",v+"年11月",v+"年12月");else if(m>90)for(h=function(e){var a,n,o,s,r,i=void 0;function l(t,e){return[31,null,31,30,31,30,31,31,30,31,30,31][e]||(function(t){return t%400==0||t%4==0&&t%100!=0}(t)?29:28)}(a=new Date(t.$format(e))).getFullYear(),a.getMonth(),a.getMonth(),a.getDate(),a.getDate(),n=a.getFullYear(),o=(a.getMonth()+1<10?"0":"")+(a.getMonth()+1),s=(a.getDate()<10?"0":"")+a.getDate(),r=n.toString().substring(2,n.length),r+o+s,i=function(t,e,a){for(var n=new Date(t,e-1,a),o=n.getFullYear(),s=n.getMonth(),r=n.getDate(),i=0;i<s;i++)r+=l(o,i);var c=new Date(o,0,1).getDay()||7,u=null;return 1===c?u=Math.ceil(r/7):(r-=7-c+1,u=Math.ceil(r/7)),u=(u<10?"0":"")+u}(n,o,s),t.ticks.push("W"+i)},_=g;_<d;_+=7*s)h(_);else for(_=g;_<d;_+=s)t.ticks.push(t.$format(_));console.log(t.ticks)}b=t,setTimeout(function(){var t=new u.a.Chart({container:"ganttes",width:1e3,height:280,padding:[0,0,0,0]});b.$chartInit(t,b.datas,b.times,0),t.render();var e=screen.availHeight-400;console.log(e),b.tableH=e},200)}case 5:case"end":return e.stop()}},e,t)}))()}},computed:{mh:function(){return Number(this.tableH)}},data:function(){return{ticks:[],gTable:[],tableH:"",ganttes:"",basicInfo:{},info:{},datas:[],datasKeys:[],times:{}}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"productPlanTable"}},[a("el-button",{staticClass:"el-button_plain_mini",attrs:{type:"primary",plain:""},on:{click:t.$goback}},[t._v("返回")]),t._v(" "),a("div",{attrs:{id:"allInfo"}},[a("h2",{staticClass:"tc fwb border_solid_bottom_c lh40"},[t._v("加工进度计划表")]),t._v(" "),a("el-row",{attrs:{gutter:10,type:"flex"}},[a("el-col",[t._v("模具编号："),a("strong",[t._v(t._s(t.basicInfo.mouldNo))])]),t._v(" "),a("el-col",{staticClass:"out",attrs:{title:t.basicInfo.partName}},[t._v("制品名称："),a("strong",[t._v(t._s(t.basicInfo.partName))])]),t._v(" "),a("el-col",[t._v("项目名称："),a("strong",[t._v(t._s(t.basicInfo.projectName))])]),t._v(" "),a("el-col",[t._v("客户名称："),a("strong",[t._v(t._s(t.basicInfo.customerUserName))])]),t._v(" "),a("el-col",[t._v("项目经理："),a("strong",[t._v(t._s(t.basicInfo.projectManager))])])],1),t._v(" "),a("div",{staticClass:"mt20"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.$goto("productPlanTableEdit")}}},[t._v("进度设置")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.export_excel}},[t._v("加工进度计划表导出")])],1),t._v(" "),t.datas.length&&t.gTable.items?a("el-table",{staticClass:"mt20",staticStyle:{width:"100%"},attrs:{"cell-class-name":"cCell",data:t.gTable.items,border:"","max-height":t.mh,"span-method":t.objectSpanMethod}},[a("el-table-column",{attrs:{align:"center",fixed:"",prop:"nodeName",label:"工序",width:"180",resizable:!1}}),t._v(" "),t._l(t.ticks,function(e,n){return a("el-table-column",{key:n,attrs:{align:"center",label:e,width:"120",resizable:!1},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{style:t.ganttes,attrs:{id:"ganttes"}})]}}],null,!0)})})],2):t._e()],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(f,g,!1,function(t){a("NlF8")},"data-v-69cab7fd",null);e.default=d.exports},NlF8:function(t,e){}});