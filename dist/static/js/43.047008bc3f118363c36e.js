webpackJsonp([43],{Z5nO:function(t,e){},uo4b:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("IHPB"),n=a.n(s),i=a("HzJ8"),r=a.n(i),l=a("ZLEe"),o=a.n(l),c=a("lC5x"),u=a.n(c),m=a("J0Oq"),p=a.n(m),d=a("glag"),h=a("c2Ch"),f=a("xd7I"),g=a("YXHf"),v=a.n(g);f.default.use(v.a);var _={name:"machine",created:function(){var t=p()(u.a.mark(function t(){var e;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.item=this.$store.getters.itemCheck_item,t.next=3,Object(h._9)({mouldCode:this.item.mouldNo});case 3:1===(e=t.sent).status&&(this.publish=e.msg);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),methods:{goto:function(){this.$router.push("/machineBad")},objectSpanMethod:function(t){var e=t.row,a=(t.column,t.rowIndex),s=t.columnIndex,n=e.itemAndPlanCodeName;if(this.gTable[n]){if(1===s&&0===a)return{rowspan:this.gTable[n].items.length,colspan:this.ticks[n].length};if(0!==s)return{rowspan:0,colspan:0};if(0===a&&0===s&&2===this.gTable[n].items.length&&!this.gTable[n].items[1].nodeName)return{rowspan:2,colspan:1}}}},beforeMount:function(){var t=this;return p()(u.a.mark(function e(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},e,t)}))()},mounted:function(){var t=this;return p()(u.a.mark(function e(){var a,s,i,l,c,m,p,f,g,_,b,w,x,y,k,D,T,C,I,M,N,S,z;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(t,e){var a=t.getDay()||7,s=864e5*(a-1),n=864e5*(7-a);return 0===e?new Date(t).getTime()-s:new Date(t).getTime()+n},e.next=3,Object(h._8)({mouldCode:t.item.mouldNo});case 3:if(1!==(s=e.sent).status||!s.msg.length){e.next=45;break}t.mapInfo=s.msg,t.gTable=s.msg,console.log(t.mapInfo),i=0;case 9:if(!(i<t.mapInfo.length)){e.next=40;break}if(t.mapInfo[i].items?t.datas[t.mapInfo[i].nodeName]=t.mapInfo[i].items:t.datas[t.mapInfo[i].nodeName]=[],t.times[i]={startTime:t.mapInfo[i].earliestDate,endTime:t.mapInfo[i].latestDate},t.datasKeys=o()(t.datas),!t.datas[t.mapInfo[i].nodeName]){e.next=33;break}for(l=!0,c=!1,m=void 0,e.prev=17,p=r()(t.datas[t.mapInfo[i].nodeName]);!(l=(f=p.next()).done);l=!0)f.value.status=0;e.next=25;break;case 21:e.prev=21,e.t0=e.catch(17),c=!0,m=e.t0;case 25:e.prev=25,e.prev=26,!l&&p.return&&p.return();case 28:if(e.prev=28,!c){e.next=31;break}throw m;case 31:return e.finish(28);case 32:return e.finish(25);case 33:if(t.gTable[i].items&&t.gTable[i].items.length<2&&(t.gTable[i].items=[].concat(n()(t.gTable[i].items),[{nodeName:""}])),g=[],_=864e5,t.mapInfo[i].earliestDate&&t.mapInfo[i].latestDate){if(b=new Date(t.mapInfo[i].earliestDate),w=new Date(t.mapInfo[i].latestDate),x=b.getFullYear(),y=w.getFullYear(),k=a(b,0),D=a(w,1),(T=(D-k)/_)>630)for(k=new Date(x+"-01-01").getTime(),D=new Date(y+"-12-31").getTime(),C=x;C<=y;C++)g.push(C+"年1月",C+"年2月",C+"年3月",C+"年4月",C+"年5月",C+"年6月",C+"年7月",C+"年8月",C+"年9月",C+"年10月",C+"年11月",C+"年12月");else if(T>90)for(I=function(e){var a,s,n,i,r,l=void 0;function o(t,e){return[31,null,31,30,31,30,31,31,30,31,30,31][e]||(function(t){return t%400==0||t%4==0&&t%100!=0}(t)?29:28)}(a=new Date(t.$format(e))).getFullYear(),a.getMonth(),a.getMonth(),a.getDate(),a.getDate(),s=a.getFullYear(),n=(a.getMonth()+1<10?"0":"")+(a.getMonth()+1),i=(a.getDate()<10?"0":"")+a.getDate(),r=s.toString().substring(2,s.length),r+n+i,l=function(t,e,a){for(var s=new Date(t,e-1,a),n=s.getFullYear(),i=s.getMonth(),r=s.getDate(),l=0;l<i;l++)r+=o(n,l);var c=new Date(n,0,1).getDay()||7,u=null;return 1===c?u=Math.ceil(r/7):(r-=7-c+1,u=Math.ceil(r/7)),u=(u<10?"0":"")+u}(s,n,i),g.push("W"+l)},M=k;M<D;M+=7*_)I(M);else for(N=k;N<D;N+=_)g.push(t.$format(N));t.ticks.push(g),console.log(t.ticks)}else t.ticks[i]=[];case 37:i++,e.next=9;break;case 40:S=o()(t.datas).length,z=t,setTimeout(function(){for(var t=0;t<S;t++)if(z.datas[z.datasKeys[t]].length){var e=new v.a.Chart({container:z.datasKeys[t],width:1e3,height:280,padding:[0,0,0,0]});console.log(z.datasKeys[t]),z.$chartInit(e,z.datas[z.datasKeys[t]],z.times[t],0),e.render();var a=screen.availHeight-400;console.log(a),z.tableH=a}},200),e.next=46;break;case 45:s.msg.length||Object(d.Message)({showClose:!0,type:"warning",message:"暂时没有加工/精修进度表的相关数据！"});case 46:case"end":return e.stop()}},e,t,[[17,21,25,33],[26,,28,32]])}))()},computed:{mh:function(){return Number(this.tableH)}},data:function(){return{ticks:[],gTable:[],tableH:"",resize:!1,ganttes:{},item:{},publish:{},mapInfo:[],datas:{},datasKeys:[],times:[],radio:"",radio1:""}}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"machine"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.$goback}},[t._v("返回")]),t._v(" "),a("div",{staticClass:"info"},[a("el-row",{staticClass:"mt20 mb20",staticStyle:{"font-size":"16px","font-weight":"bold"}},[a("el-tag",[t._v("基本信息：")])],1),t._v(" "),a("el-row",{staticStyle:{"padding-left":"20px"},attrs:{gutter:10,type:"flex",justify:"space-around"}},[a("el-col",{staticClass:"ovw-h",attrs:{span:6}},[a("p",{staticClass:"fl"},[t._v("图片：")]),t._v(" "),a("p",{staticClass:"fl",staticStyle:{width:"calc(100% - 100px)"}},[a("img",{staticStyle:{height:"77px",width:"auto !important"},attrs:{src:t.item.imgUrl,alt:"图例"}})])]),t._v(" "),a("el-col",{attrs:{span:6}},[a("p",[t._v("项目名称："+t._s(t.item.projectName))]),t._v(" "),a("p",[t._v("客户名称："+t._s(t.item.customerUserName))])]),t._v(" "),a("el-col",{attrs:{span:6}},[a("p",{staticClass:"out",attrs:{title:t.item.partName}},[t._v("制品名称："+t._s(t.item.partName))]),t._v(" "),a("p",[t._v("制品尺寸："+t._s(t.item.partNo))])]),t._v(" "),a("el-col",{attrs:{span:6}},[a("p",[t._v("模具编号："+t._s(t.item.mouldNo))])])],1),t._v(" "),a("hr"),t._v(" "),a("el-row",{staticClass:"mt20 mb20",staticStyle:{"font-size":"16px","font-weight":"bold"}},[a("el-tag",[t._v("加工统计：")])],1),t._v(" "),a("el-row",{staticStyle:{"padding-left":"20px"}},[t._v("加工零件总数:"+t._s(t.publish.itemPartTotal))]),t._v(" "),a("el-row",{staticStyle:{"padding-left":"20px","line-height":"40px"},attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[t._v("已加工完成零件："+t._s(t.publish.itemPartFinishMath))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("加工中零件："+t._s(t.publish.itemPartMachiningMath))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("预计加工完成时间："+t._s(t.publish.planCompletionTime?t.$format(new Date(t.publish.planCompletionTime).getTime()):""))]),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{"padding-right":"10px"}},[t._v("不合格零件："+t._s(t.publish.unqualifiedMath?t.publish.unqualifiedMath:"0")+"个")])])],1),t._v(" "),a("hr")],1),t._v(" "),a("div",{staticClass:"tn",staticStyle:{padding:"40px"}},t._l(t.datasKeys,function(e,s){return a("div",{key:s,staticClass:"node mt20"},[a("el-tag",[t._v(t._s(e)+"进度查看:")]),t._v(" "),a("div",[t.datas[e].length?t._e():a("p",{staticStyle:{"padding-left":"150px"}},[t._v("暂时没有相关数据！")]),t._v(" "),t.datas[e].length&&t.gTable[s].items?a("el-table",{staticClass:"mt20",staticStyle:{width:"100%"},attrs:{"cell-class-name":"cCell",data:t.gTable[s].items,border:"","max-height":t.mh,"span-method":t.objectSpanMethod}},[a("el-table-column",{attrs:{align:"center",fixed:"",prop:"nodeName",label:"工序",width:"180",resizable:t.resize}}),t._v(" "),t._l(t.ticks[s],function(s,n){return a("el-table-column",{key:n,attrs:{align:"center",label:s,width:"120",resizable:t.resize},scopedSlots:t._u([{key:"default",fn:function(s){return[a("div",{style:t.ganttes,attrs:{id:e}})]}}],null,!0)})})],2):t._e()],1)],1)}),0)],1)},staticRenderFns:[]};var w=a("C7Lr")(_,b,!1,function(t){a("Z5nO")},"data-v-1601482e",null);e.default=w.exports}});