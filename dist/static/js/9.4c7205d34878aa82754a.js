webpackJsonp([9],{SrHE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("3cXf"),s=r.n(a),o=r("HzJ8"),n=r.n(o),l=r("lC5x"),i=r.n(l),c=r("J0Oq"),u=r.n(c),m=r("glag"),p=r("c2Ch"),f={name:"userManage",created:function(){var e=u()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.getUserLists(),e.next=3,Object(p.K)();case 3:t=e.sent,console.log(t),this.search.optionsRole=t.msg;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{getUserLists:function(){var e=this;return u()(i.a.mark(function t(){var r,a,s,o,l,c,u,m,f;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={page:1,size:e.size},t.next=3,Object(p.Q)(r);case 3:for(a=t.sent,s=!0,o=!1,l=void 0,t.prev=7,c=n()(a.msg.content);!(s=(u=c.next()).done);s=!0)m=u.value,console.log(m),f=e.$format(m.createTime),m.createTime=f;t.next=15;break;case 11:t.prev=11,t.t0=t.catch(7),o=!0,l=t.t0;case 15:t.prev=15,t.prev=16,!s&&c.return&&c.return();case 18:if(t.prev=18,!o){t.next=21;break}throw l;case 21:return t.finish(18);case 22:return t.finish(15);case 23:e.tableData=a.msg;case 24:case"end":return t.stop()}},t,e,[[7,11,15,23],[16,,18,22]])}))()},handleClick:function(e,t){this.dialogFormVisible=!0,null!==e&&void 0!==e&&"{}"!==s()(e)?(this.form=e,this.form.role||(this.form.role={id:null}),this.flag=1):(this.form={role:{id:""}},this.flag=0),this.form.entrance=t,this.dialogTitle="0"===t?"添加用户":"修改用户",console.log(e)},deleteUser:function(e){var t=this;return u()(i.a.mark(function r(){return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(p.n)({userId:e.userId});case 2:1===r.sent.status&&(Object(m.Message)({showClose:!0,type:"success",message:"删除用户成功！"}),t.getUserLists());case 4:case"end":return r.stop()}},r,t)}))()},searchList:function(e){var t=this;return u()(i.a.mark(function r(){var a,s,o,l,c,u,m,f,d;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a={page:1,size:t.size},""!==e.role&&(a.roleId=e.role),""!==e.accountName&&(a.accountNo=e.accountName),""!==e.userName&&(a.userName=e.userName),console.log(a),r.next=7,Object(p.Q)(a);case 7:for(s=r.sent,o=!0,l=!1,c=void 0,r.prev=11,u=n()(s.msg.content);!(o=(m=u.next()).done);o=!0)f=m.value,console.log(f),d=t.$format(f.createTime),f.createTime=d;r.next=19;break;case 15:r.prev=15,r.t0=r.catch(11),l=!0,c=r.t0;case 19:r.prev=19,r.prev=20,!o&&u.return&&u.return();case 22:if(r.prev=22,!l){r.next=25;break}throw c;case 25:return r.finish(22);case 26:return r.finish(19);case 27:t.tableData=s.msg;case 28:case"end":return r.stop()}},r,t,[[11,15,19,27],[20,,22,26]])}))()},changeStatus:function(e){var t=this;return u()(i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a={userId:e.userId,status:e.status},r.next=3,Object(p._27)(a);case 3:1===r.sent.status&&t.$message({showClose:!0,message:"修改成功",type:"success",center:!0});case 5:case"end":return r.stop()}},r,t)}))()},cancelAdd:function(){this.$refs.ruleForm.clearValidate()},userOperation:function(e){var t,r=this;this.$refs.ruleForm.validate((t=u()(i.a.mark(function t(a){var s,o,l,c,u,f,d,h,v,b;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=48;break}if(!(5!==e.role.id&&e.workNo||5===e.role.id)){t.next=45;break}if(s=e,void 0,"0"!==e.entrance){t.next=10;break}return t.next=7,Object(p.g)(s);case 7:t.sent,t.next=13;break;case 10:return t.next=12,Object(p._28)(s);case 12:t.sent;case 13:return 0===r.flag&&(r.currentPage=1),o={page:r.currentPage,size:r.size},""!==r.search.role&&(o.roleId=r.search.role),""!==r.search.accountName&&(o.accountNo=r.search.accountName),""!==r.search.userName&&(o.userName=r.search.userName),t.next=20,Object(p.Q)(o);case 20:for(1===(l=t.sent).status&&Object(m.Message)({showClose:!0,type:"success",message:"添加或修改用户成功！"}),c=!0,u=!1,f=void 0,t.prev=25,d=n()(l.msg.content);!(c=(h=d.next()).done);c=!0)v=h.value,console.log(v),b=r.$format(v.createTime),v.createTime=b;t.next=33;break;case 29:t.prev=29,t.t0=t.catch(25),u=!0,f=t.t0;case 33:t.prev=33,t.prev=34,!c&&d.return&&d.return();case 36:if(t.prev=36,!u){t.next=39;break}throw f;case 39:return t.finish(36);case 40:return t.finish(33);case 41:r.tableData=l.msg,r.dialogFormVisible=!1,t.next=46;break;case 45:5!==e.role.id&&Object(m.Message)({showClose:!0,type:"error",message:"请填写工号！"});case 46:t.next=50;break;case 48:return Object(m.Message)({showClose:!0,type:"error",message:"请仔细检查是否填写正确！"}),t.abrupt("return",!1);case 50:case"end":return t.stop()}},t,r,[[25,29,33,41],[34,,36,40]])})),function(e){return t.apply(this,arguments)}))},handleCurrentChange:function(e){var t=this;return u()(i.a.mark(function r(){var a,s,o,l,c,u,m,f,d;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.currentPage=e,a={page:e,size:t.size},r.next=4,Object(p.Q)(a);case 4:for(s=r.sent,o=!0,l=!1,c=void 0,r.prev=8,u=n()(s.msg.content);!(o=(m=u.next()).done);o=!0)f=m.value,console.log(f),d=t.$format(f.createTime),f.createTime=d;r.next=16;break;case 12:r.prev=12,r.t0=r.catch(8),l=!0,c=r.t0;case 16:r.prev=16,r.prev=17,!o&&u.return&&u.return();case 19:if(r.prev=19,!l){r.next=22;break}throw c;case 22:return r.finish(19);case 23:return r.finish(16);case 24:t.tableData=s.msg,console.log("当前页: "+e);case 26:case"end":return r.stop()}},r,t,[[8,12,16,24],[17,,19,23]])}))()},submit:function(e){this.dialogFormVisible=!1,console.log(e)}},data:function(){return{currentPage:1,size:5,dialogFormVisible:!1,flag:0,dialogTitle:"",form:{role:{roleName:""},entrance:0},rules:{accountName:[{required:!0,validator:function(e,t,r){t?/^\w+$/.test(t)?r():r(new Error("请正确填写，支持英文大小写、数字和下划线_，20字以内")):r(new Error("账户名称不能为空！"))},trigger:"change"},{required:!0,min:6,max:20,trigger:"change",message:"请控制在6~20个字符以内!"}],userName:[{required:!0,max:20,trigger:"change",message:"请控制在20个字符以内，但不能为空!"}]},search:{role:"",optionsRole:[],accountName:"",optionsAccountName:[],userName:"",optionsUserName:[]},tableData:[],options:[{status:1,label:"已启用"},{status:0,label:"已停用"}]}}},d={render:function(){var e=this,t=this,r=t.$createElement,a=t._self._c||r;return a("div",{attrs:{id:"userManage"}},[a("div",{staticClass:"section-search mb20 mt20"},[a("el-row",{staticClass:"mb20"},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"fl mr20"},[a("span",[t._v("用户角色：")]),t._v(" "),a("el-select",{attrs:{filterable:"",clearable:""},model:{value:t.search.role,callback:function(e){t.$set(t.search,"role",e)},expression:"search.role"}},t._l(t.search.optionsRole,function(e){return a("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}),1)],1),t._v(" "),a("div",{staticClass:"fl mr20"},[a("span",[t._v("账户名称：")]),t._v(" "),a("el-input",{staticStyle:{width:"auto"},model:{value:t.search.accountName,callback:function(e){t.$set(t.search,"accountName",e)},expression:"search.accountName"}})],1),t._v(" "),a("div",{staticClass:"fl mr20"},[a("span",[t._v("用户名称：")]),t._v(" "),a("el-input",{staticStyle:{width:"auto"},model:{value:t.search.userName,callback:function(e){t.$set(t.search,"userName",e)},expression:"search.userName"}})],1),t._v(" "),a("el-button",{staticClass:"fl",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.searchList(t.search)}}})],1)],1),t._v(" "),a("hr")],1),t._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(e){return t.handleClick({},"0")}}},[t._v("添加账户")]),t._v(" "),a("div",{staticClass:"allocated mt20",staticStyle:{"padding-left":"30px"}},[a("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:t.tableData.content,border:"","header-cell-class-name":"header_cell table_header_shadow"}},[a("el-table-column",{attrs:{fixed:"left",type:"index",width:"50",label:"序号",index:function(r){return e.$indexS(r,t.currentPage,t.size)}}}),t._v(" "),a("el-table-column",{attrs:{prop:"accountName",label:"账户名称",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"用户角色",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(null!=e.row.role?e.row.role.roleName:""))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:function(r){return t.changeStatus(e.row)}},model:{value:e.row.status,callback:function(r){t.$set(e.row,"status",r)},expression:"scope.row.status"}},t._l(t.options,function(e){return a("el-option",{key:e.status,attrs:{label:e.label,value:e.status}})}),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"用户名称",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"workNo",label:"工号（选填）",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"organize",label:"公司/部门",width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"area",label:"所属区域/国家",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号码",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mail",label:"邮箱","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"button-small",attrs:{size:"mini",type:"primary",icon:"el-icon-edit",plain:"",title:"编辑"},on:{click:function(r){return t.handleClick(e.row,"1")}}}),t._v(" "),a("el-button",{staticClass:"button-small",attrs:{size:"mini",type:"primary",icon:"el-icon-delete",plain:"",title:"删除"},on:{click:function(r){return t.deleteUser(e.row)}}})]}}])})],1)],1),t._v(" "),a("div",{staticClass:"pagination fr ovw-h"},[t.tableData.totalCount?a("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.size,layout:"total, prev, pager, next",total:t.tableData.totalCount},on:{"size-change":function(e){},"current-change":t.handleCurrentChange}}):t._e()],1),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogFormVisible,width:"50%",center:""},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.cancelAdd}},[a("hr"),t._v(" "),a("el-form",{ref:"ruleForm",staticClass:"mt20",attrs:{model:t.form,"status-icon":"",rules:t.rules,"label-width":"130px","label-position":"right"}},[a("el-form-item",{attrs:{prop:"accountName",label:"账户名称："}},[a("el-input",{attrs:{placeholder:"请输入账户"},model:{value:t.form.accountName,callback:function(e){t.$set(t.form,"accountName",e)},expression:"form.accountName"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"userName",label:"用户名称："}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.form.userName,callback:function(e){t.$set(t.form,"userName",e)},expression:"form.userName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"用户角色：",prop:"role.id",rules:[{required:!0,message:"该项不能为空！",trigger:"change"}]}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.role.id,callback:function(e){t.$set(t.form.role,"id",e)},expression:"form.role.id"}},t._l(t.search.optionsRole,function(e){return a("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}),1)],1),t._v(" "),5!==t.form.role.id?a("el-form-item",{attrs:{label:"工号：",prop:"workNo",rules:[{required:!0,max:10,message:"不能超过十个字符！",trigger:["blur","change"]}]}},[a("el-input",{attrs:{placeholder:"请输入工号",disabled:5===t.form.role.id},model:{value:t.form.workNo,callback:function(e){t.$set(t.form,"workNo",e)},expression:"form.workNo"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"所属区域/国家：",prop:"area",rules:[{required:!0,max:50,message:"该项不能为空！",trigger:"change"}]}},[a("el-input",{attrs:{placeholder:"请输入区域/国家"},model:{value:t.form.area,callback:function(e){t.$set(t.form,"area",e)},expression:"form.area"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"公司名称/部门：",prop:"organize",rules:[{required:!0,max:50,message:"该项不能为空！",trigger:"change"}]}},[a("el-input",{attrs:{placeholder:"请输入公司/部门"},model:{value:t.form.organize,callback:function(e){t.$set(t.form,"organize",e)},expression:"form.organize"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"手机号码：",prop:"mobile",rules:[{required:!0,min:11,max:11,message:"请输入11位手机号码",trigger:"change"}]}},[a("el-input",{attrs:{type:"age",autocomplete:"off"},model:{value:t.form.mobile,callback:function(e){t.$set(t.form,"mobile",e)},expression:"form.mobile"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"mail",label:"邮箱：",rules:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]}},[a("el-input",{model:{value:t.form.mail,callback:function(e){t.$set(t.form,"mail",e)},expression:"form.mail"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.userOperation(t.form)}}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var h=r("C7Lr")(f,d,!1,function(e){r("WiRo")},"data-v-bfee78fa",null);t.default=h.exports},WiRo:function(e,t){}});